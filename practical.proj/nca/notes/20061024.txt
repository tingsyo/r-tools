2006.10.24

Because UCI wine data have 13 dimensions and 178 data points, which is a little large for testing,  I create a smaller dataset for testing the NCA-kNN classifier.

[Test Data: Concentric rings]
100 points in 3-D space.  For class 0, each dimension is norm(0,1), and norm(0.75,1) for class 1.

[Data]
<pre>
              x.1         x.2           x.3 class
 [1,]  0.19732645  0.55015544 -1.2107316625     0
 [2,] -0.27287949  0.17421214 -0.1071743231     0
 [3,]  0.35003758  1.51825779 -0.8937894145     0
 [4,]  0.21701950  0.73795954  1.2049081139     0
 [5,] -1.47901017 -1.17060147  0.8067818782     0
 [6,]  0.90952893 -1.58842244 -0.1186827335     0
 [7,]  0.41629459  0.84309540  1.1373280436     0
 [8,] -0.21496205  1.99717552  0.0724046581     0
 [9,]  1.10014251 -0.13606651  0.3870888350     0
[10,] -0.56658327  0.69878572  0.0459412282     0
[11,]  0.13519228  0.82678952  0.7017321141     0
[12,]  1.10582821  0.86778411  3.4547443439     0
[13,] -0.46431547  1.25997983  1.6757779093     0
[14,] -0.86524315  1.18929969 -1.8942394518     0
[15,]  0.93690711  0.01201530 -1.2116971793     0
[16,] -0.34961217  0.91447261  0.5354195003     0
[17,]  0.59021626  0.57232188  1.0539093013     0
[18,] -1.27116493 -0.71123006 -0.5981764187     0
[19,] -0.31713548  0.66482523 -1.1577488212     0
[20,]  0.02844143  0.42557632 -0.9695321371     0
[21,] -1.03201131 -0.16127643 -2.5005217209     0
[22,]  0.33304924 -0.18386190 -1.2006433959     0
[23,] -2.30000937  0.17864006  1.2599020846     0
[24,]  0.80883699  0.51240316  0.5281438537     0
[25,] -1.67505004  1.92474130  1.1589895844     0
[26,] -1.46071684 -0.86526639 -0.2765244556     0
[27,]  0.08204891  0.31032255  0.3538574001     0
[28,] -0.02286304  0.24932740  0.2183845157     0
[29,] -0.28545581  2.17696359  0.1420949529     0
[30,]  0.53136975 -0.49576285 -0.5235739401     0
[31,] -0.16909941 -0.10688458 -0.6178071451     0
[32,] -1.41834406  1.01254419 -0.6950881329     0
[33,] -1.35348993 -1.34106774 -2.4107825585     0
[34,]  0.63745723 -0.90175163 -0.4454831243     0
[35,] -0.86856228 -0.55183386 -0.0756737104     0
[36,]  0.09129757  0.02034605  0.6322550732     0
[37,]  0.40684369 -0.01383833 -1.4702747431     0
[38,]  0.12435405  0.69934764  1.9276391638     0
[39,]  2.19893119 -0.44523470 -1.7896593283     0
[40,] -0.22751351 -0.57816740 -0.1901571518     0
[41,] -1.53781902  0.17411212 -0.7810997764     0
[42,]  1.77718271 -0.88803671 -1.8410015105     0
[43,] -0.43795103 -1.65825813 -0.8193735471     0
[44,]  0.70064290 -1.95148843  0.2854610396     0
[45,]  0.18228724 -0.63963591  2.1707327351     0
[46,]  0.09048557 -0.48320286 -1.2725416211     0
[47,]  0.01916324  2.39912047  0.0758723189     0
[48,] -0.56162036  0.69487560  0.7534945795     0
[49,] -2.05018022  1.32473051 -1.1932059167     0
[50,]  0.05356074  0.31598290  0.0002464994     0
[51,]  0.52596519  1.18943250  0.6723439032     1
[52,] -0.32971454  0.40617166  2.0971071843     1
[53,]  1.50832190  0.63576472  0.4136908420     1
[54,]  2.17826643  2.61214004 -1.2838137650     1
[55,]  1.19121285  1.09515144  0.7373536089     1
[56,]  0.98870291  2.03084774  1.9035088785     1
[57,]  1.78622917  0.80741338 -0.1281582188     1
[58,]  0.64064799  2.28868629  0.3664629243     1
[59,]  0.64705962  0.71425050 -0.2833209397     1
[60,]  2.18275667 -0.19043811  2.2885847100     1
[61,]  2.69187657  0.92520684  1.6300461542     1
[62,]  1.46660425  1.13550100  0.2492622545     1
[63,]  1.93085888  2.57856584 -0.5905291718     1
[64,]  0.01679718  0.45108420  1.7848202310     1
[65,]  0.89014208  2.05499942  2.1079609516     1
[66,]  2.26282638  0.76672722  2.6532727290     1
[67,]  1.52723266  1.97292395  1.3096440280     1
[68,]  1.09277224  1.24213296  1.9512145756     1
[69,]  0.17787461  2.30438049 -0.2468923118     1
[70,] -0.51606317  1.07622791  0.2934998909     1
[71,]  2.10787103 -0.36587036  1.0785507046     1
[72,]  0.29744203  2.55655424  1.3336125110     1
[73,]  2.23856078  1.11995893  1.7238383175     1
[74,]  2.38843705  2.42125081  1.1716446268     1
[75,]  0.69112708  1.51561594  0.7508439388     1
[76,]  1.94568756  2.28788847 -0.7860523064     1
[77,]  1.82723289  3.01095739  1.9613547955     1
[78,]  0.82903557  2.05954417  2.9706085833     1
[79,]  1.46652299  1.40576224  1.8956173820     1
[80,] -0.25554453  2.47696430  2.5562248449     1
[81,]  1.13691150  0.81538931  0.1934839137     1
[82,]  1.48886024  0.67713809  0.7718755826     1
[83,]  0.78512118  0.27074846  1.0537555824     1
[84,]  1.57803262  1.60925300  1.2486603004     1
[85,]  1.58369590  0.29080467  3.2223781213     1
[86,] -0.05603752  0.92543502  0.7918436260     1
[87,]  2.71070427  1.18430598  0.3331529413     1
[88,]  1.78488829  0.73059994  1.3949629338     1
[89,]  1.20134560  1.28869812  0.8920241721     1
[90,]  0.34449645  2.67188474  0.2347546071     1
[91,] -0.83792785 -0.46881701  0.9439761574     1
[92,]  1.37188962 -0.91595009 -0.2376354536     1
[93,]  1.66772480  1.19351944  0.1157750409     1
[94,]  1.51532254  0.98297596  1.8762570603     1
[95,]  0.50088282  0.66449024  1.2103671660     1
[96,]  1.61096153  2.99561319  3.1045813440     1
[97,]  0.91042466  1.46940546  1.2383703675     1
[98,]  0.94825891 -0.04731804  2.8500530592     1
[99,]  2.46217391  1.35947546  1.9112608221     1
[100,]  1.27511155  0.52593332  1.3409540433     1
</pre>

[Test Results]
1. LOO CV:
(1) kNN without NCA                     (kNN)    : 0.22
(2) NCA start with I                    (NCA-IDE): 0.22
(3) NCA start with Sigma^(-1/2)         (NCA-COV): 0.21
(4) NCA start with pooled Sigma^(-1/2)  (NCA-PCV): 0.20
Note: Sigma = covariance matrix of training data


2. Comments:
(1) It is no suprised that NCA-IDE gives the same results as non-transformed kNN, since this approach always returns a diagonal matrix after optimization. The linear re-scaling will not change the results of kNN.

(2) So far it seems that: NCA-PCV > NCA-COV > NCA-IDE=kNN
    Later on more tests will be performed on other datasets.

Note: well, this operation really takes a while, about 40 mins on the 2-Xeon-2.8G with 1G RAM Linux workstation.... 
Does R support multi-processors till now? No, see <a href=http://finzi.psych.upenn.edu/R/Rhelp02a/archive/68016.html">http://finzi.psych.upenn.edu/R/Rhelp02a/archive/68016.html</a>.

(3) ToDo:
  - Dimension reduction, d=# of independent variables by default -> no reduction
  - Make choice of initial guess as built-in optin? (then it may become confusing when trying to give other initial guess....)

